<!DOCTYPE html>
<!-- Template Name: Clip-One - Responsive Admin Template build with Twitter Bootstrap 3.x Version: 1.3 Author: ClipTheme -->
<!--[if IE 8]><html class="ie8 no-js" lang="en"><![endif]-->
<!--[if IE 9]><html class="ie9 no-js" lang="en"><![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- start: HEAD -->

<head>
<title>Clip-One - Responsive Admin Template</title>
<!-- start: META -->
<meta charset="utf-8" />
<!--[if IE]><meta http-equiv='X-UA-Compatible' content="IE=edge,IE=9,IE=8,chrome=1" /><![endif]-->
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta content="" name="description" />
<meta content="" name="author" />
<!-- end: META -->
<!-- start: MAIN CSS -->
<link rel="stylesheet"
	href="${base.contextPath}/assets/plugins/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet"
	href="${base.contextPath}/assets/plugins/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="${base.contextPath}/assets/fonts/style.css">
<link rel="stylesheet" href="${base.contextPath}/assets/css/main.css">
<link rel="stylesheet"
	href="${base.contextPath}/assets/css/main-responsive.css">
<link rel="stylesheet"
	href="${base.contextPath}/assets/plugins/iCheck/skins/all.css">
<link rel="stylesheet"
	href="${base.contextPath}/assets/plugins/bootstrap-colorpalette/css/bootstrap-colorpalette.css">
<link rel="stylesheet"
	href="${base.contextPath}/assets/plugins/perfect-scrollbar/src/perfect-scrollbar.css">
<link rel="stylesheet"
	href="${base.contextPath}/assets/css/theme_light.css" type="text/css"
	id="skin_color">
<link rel="stylesheet" href="${base.contextPath}/assets/css/print.css"
	type="text/css" media="print" />
<!--[if IE 7]>
		<link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome-ie7.min.css">
		<![endif]-->
<!-- end: MAIN CSS -->
<!-- start: CSS REQUIRED FOR THIS PAGE ONLY -->
<link
	href="${base.contextPath}/assets/plugins/jquery-ui/jquery-ui-1.10.1.custom.min.css"
	rel="stylesheet" />
<link rel="stylesheet"
	href="${base.contextPath}/assets/plugins/dynatree/src/skin-vista/ui.dynatree.css">
<!-- end: CSS REQUIRED FOR THIS PAGE ONLY -->
<link rel="shortcut icon" href="favicon.ico" />
</head>
<!-- end: HEAD -->
<!-- start: BODY -->

<body>

	<div class="main-container">

		<div class="container">
			<!-- start: PAGE CONTENT -->
			<div class="row">
				<div class="col-md-6">
					<!-- start: DEFAULT TREE PANEL -->
					<div class="panel panel-default">
						<div class="panel-heading">
							<i class="fa fa-sitemap"></i> 部门管理
							<div class="panel-tools">
								<a class="btn" id="addClick" href="#" data-toggle="tooltip"
									title="添加"><span class="glyphicon glyphicon-plus"></span> </a>
								<a class="btn" id="editClick" href="#" data-toggle="tooltip"
									title="编辑"><span class="glyphicon glyphicon-edit"></span> </a>
								<a class="btn" id="rmClick" href="#" data-toggle="tooltip"
									title="删除"><span class="glyphicon glyphicon-trash"></span> </a>
								<a class="btn btn-xs btn-link panel-collapse collapses" href="#">
								</a> <a class="btn btn-xs btn-link panel-config"
									href="#panel-config" data-toggle="modal"> <i
									class="fa fa-wrench"></i>
								</a> <a class="btn btn-xs btn-link panel-refresh" href="#"> <i
									class="fa fa-refresh"></i>
								</a> <a class="btn btn-xs btn-link panel-expand" href="#"> <i
									class="fa fa-resize-full"></i>
								</a> <a class="btn btn-xs btn-link panel-close" href="#"> <i
									class="fa fa-times"></i>
								</a>
							</div>
						</div>

						<div class="panel-body">
							<div id="tree6"></div>

						</div>
					</div>

				</div>
			</div>
			<!-- end: PAGE -->
		</div>
		<!-- start: MAIN JAVASCRIPTS -->
		<!--[if lt IE 9]>
		<script src="assets/plugins/respond.min.js"></script>
		<script src="assets/plugins/excanvas.min.js"></script>
		<script type="text/javascript" src="assets/plugins/jquery/1.10.2/jquery.min.js"></script>
		<![endif]-->
		<!--[if gte IE 9]><!-->
		<script
			src="${base.contextPath}/assets/plugins/jquery/2.0.3/jquery.min.js"></script>
		<!--<![endif]-->
		<script type="text/javascript"
			src="${base.contextPath}/layer-2.x/layer.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/jquery-ui/jquery-ui-1.10.2.custom.min.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/blockUI/jquery.blockUI.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/iCheck/jquery.icheck.min.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/perfect-scrollbar/src/jquery.mousewheel.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/perfect-scrollbar/src/perfect-scrollbar.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/less/less-1.5.0.min.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/jquery-cookie/jquery.cookie.js"></script>
		<script
			src="${base.contextPath}/assets/plugins/bootstrap-colorpalette/js/bootstrap-colorpalette.js"></script>
		<script src="${base.contextPath}/assets/js/main.js"></script>
		<!-- end: MAIN JAVASCRIPTS -->
		<!-- start: JAVASCRIPTS REQUIRED FOR THIS PAGE ONLY -->
		<script
			src="${base.contextPath}/assets/plugins/jquery-ui/jquery-ui-1.10.1.custom.min.js"
			type="text/javascript"></script>
		<script
			src="${base.contextPath}/assets/plugins/dynatree/src/jquery.dynatree.js"></script>
		<script src="${base.contextPath}/assets/js/ui-treeview.js"></script>
		<!-- end: JAVASCRIPTS REQUIRED FOR THIS PAGE ONLY -->
		<script>
			var selectId = 0;
			jQuery(document)
					.ready(
							function() {
								Main.init();
								/* var index = layer.load(0, {time: 1000}); */
								
								$("#tree6")
										.dynatree(
												{
													initAjax : {
														url : "${base.contextPath}/department/listTree"
													},
													checkbox : true,
													// Override class name for checkbox icon:
													classNames : {
														checkbox : "dynatree-radio"
													},
													selectMode : 1,
													onSelect : function(select,
															node) {
														// Display list of selected nodes

														selectId = node.data.id;
													},
													onDblClick : function(node,
															event) {
														node.toggleSelect();
													},
													onKeydown : function(node,
															event) {
														if (event.which == 32) {
															node.toggleSelect();
															return false;
														}
													},
													/*onLazyRead: function (node) {
													    // Mockup a slow reqeuest ...
													    node.appendAjax({
													        url: "sample-data2.json",
													        debugLazyDelay: 750 // don't do this in production code
													    });
													},*/
													dnd : {
														preventVoidMoves : true, // Prevent dropping nodes 'before self', etc.
														onDragStart : function(
																node) {
															/** This function MUST be defined to enable dragging for the tree.
															 *  Return false to cancel dragging of node.
															 */
															return true;
														},

														onDragEnter : function(
																node,
																sourceNode) {
															if (node.parent !== sourceNode.parent) {
																return false;
															}
															// Don't allow dropping *over* a node (would create a child)
															return [ "before",
																	"after" ];
														},
														onDrop : function(node,
																sourceNode,
																hitMode, ui,
																draggable) {
															/** This function MUST be defined to enable dropping of items on
															 *  the tree.
															 */
															sourceNode.move(
																	node,
																	hitMode);
														}
													}
												});
							});
			$('#addClick')
					.on(
							"click",
							function() {
								layer
										.open({
											type : 2,
											area : [ '800px', '860px' ],
											title : '添加用户',
											shadeClose : true, //点击遮罩关闭层
											content : '${base.contextPath}/department/editView?state="add"&id=0'
										});
							});
			$('#rmClick')
					.on(
							"click",
							function() {
								if (selectId <= 0) {
									layer.confirm('你还没有选择要删除的部门', function(
											index) {
										layer.close(index);
									});
								} else {
									layer
											.confirm(
													'确定要删除用户?',
													function(index) {
														$
																.ajax({
																	url : "${base.contextPath}/department/delete",
																	type : 'post',
																	data : 'id='
																			+ selectId,
																	success : function(
																			text) {
																		if (text == "1") {
																			window.location
																					.reload();
																		} else {
																			alert('删除失败');
																			layer
																					.close(index);
																		}
																	},
																	error : function(
																			jqXHR,
																			textStatus,
																			errorThrown) {
																		if (400 == jqXHR.status
																				|| 403 == jqXHR.status
																				|| 500 == jqXHR.status)
																			return;
																		var text = "操作失败，"
																				+ jqXHR.responseText;
																		alert(text);
																	}
																});
													});
								}
							});
			$('#editClick')
					.on(
							"click",
							function() {
								if (selectId <= 0) {
									layer.confirm('你还没有选择要修改的部门', function(
											index) {
										layer.close(index);
									});
								} else {
									layer
											.open({
												type : 2,
												area : [ '800px', '860px' ],
												title : '添加用户',
												shadeClose : true, //点击遮罩关闭层
												content : '${base.contextPath}/department/editView?state='
														+ "edit"
														+ '&id='
														+ selectId
											});
								}
							});
		</script>
</body>
<!-- end: BODY -->

</html>